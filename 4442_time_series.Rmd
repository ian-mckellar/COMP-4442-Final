---
title: "COMP-4442 Final Project"
author: "Zack Larson, Ian McKellar, Suvechhya Pokhrel"
date: "3/2/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(ggpubr)

```

## R Markdown

Data Parsing / Cleanup

```{r}

election_raw <- read.csv('countypres_2000-2020.csv', header=TRUE, sep=",") #election data

election_raw$state <- as.factor(election_raw$state)
election_raw$county_name <- as.factor(election_raw$county_name)
election_raw$candidate <- as.factor(election_raw$candidate)
election_raw$party <- as.factor(election_raw$party)

election_2020_counties_won <- election_raw %>% filter(year==2020) %>% group_by(county_name) %>%  filter(candidatevotes == max(candidatevotes, na.rm=TRUE)) %>% ungroup() # County level results

election_2020 <- election_raw %>% filter(year==2020) # County level total votes

election_2020_counties_won <- droplevels(election_2020_counties_won) # Remove unused factors
election_2020 <- droplevels(election_2020)

election_2020_state <- election_raw %>% filter(year==2020)
election_2020_state <- aggregate(candidatevotes~state+candidate,data=election_2020_state, FUN=sum)
election_2020_state <- election_2020_state %>% group_by(state) %>%  filter(candidatevotes == max(candidatevotes, na.rm=TRUE)) %>% ungroup() # Results per state

election_2020_state <- droplevels(election_2020_state)

```

Plots & exploratory data analysis

```{r}

# Sample data and plots for CO

colorado_data <- subset(election_2020, state=='COLORADO')
colorado_data_counties_won <- subset(election_2020_counties_won, state=='COLORADO')

candidate_votes_co <- ggplot(data=colorado_data, aes(x=candidate, y=candidatevotes)) +
  geom_col() + scale_y_continuous(labels = scales::comma) +
  scale_x_discrete(guide = guide_axis(n.dodge=2)) + ggtitle('Votes per Candidate in CO')

county_candidate_co <- ggplot(data=colorado_data_counties_won, aes(candidate)) +
  geom_bar() + ggtitle('CO Counties per Candidate')


figure <- ggarrange(candidate_votes_co, county_candidate_co,
                    labels = c("1", "2"),
                    ncol = 2, nrow = 1)
figure

# Add % of voter turnout per county plot?

```

Time Series Analysis

```{r}



```
